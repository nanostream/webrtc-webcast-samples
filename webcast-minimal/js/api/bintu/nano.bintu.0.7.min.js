!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t){(function(){"use strict";function e(){this.state=this.setState(e.STATE.ALL),this.tags=[]}var t=function(e,t,r,n,o,s){if(!(e.length>0&&("string"==typeof e||e instanceof String)))throw new Error("The param 'apiUrl' must be of type 'string' and also may not be empty string.");if(this.apiUrl=e,t&&("string"==typeof t||t instanceof String)&&(this.apiKey=t),o&&("string"==typeof o||o instanceof String)&&(this.playerKey=o),s&&("string"==typeof s||s instanceof String)){if("api"!==s&&"player"!==s)throw new Error("The param 'keyMode' must be 'api', 'player' or undefined");this.keyMode=s}this.isWebrtcStream=!!r,this.isTranscodedStream=!!n},r=t.prototype,n=function(e,t,r,n,o,s){var i=this;i.method=e||"GET",i.url=t||"http://localhost:8088",i.header=r||{},i.async=n||!0,i.onSuccess=o||function(e){},i.onError=s||function(e){},i.Send=function(e){var t=new XMLHttpRequest;t.open(i.method,i.url,i.async);for(var r in i.header)t.setRequestHeader(r,i.header[r]);if(t.onreadystatechange=function(){4===t.readyState&&200===t.status?"function"==typeof i.onSuccess&&i.onSuccess(t):4===t.readyState&&200!==t.status&&"function"==typeof i.onError&&i.onError({error:"onstatuserror",request:t})},t.onabort=function(){"function"==typeof i.onError&&i.onError({error:"onabort",request:t})},t.onerror=function(){"function"==typeof i.onError&&i.onError({error:"onerror",request:t})},t.ontimeout=function(){"function"==typeof i.onError&&i.onError({error:"ontimeout",request:t})},"undefined"!=typeof e){if("string"==typeof e)try{e=JSON.parse(e)}catch(r){e=null,"function"==typeof i.onError&&i.onError({error:"invalid json string",request:t})}if("object"==typeof e)try{e=JSON.stringify(e),t.send(e)}catch(e){"function"==typeof i.onError&&i.onError({error:"invalid json object",request:t})}}else t.send()}};r.apiKey=null,r.apiUrl=null,r.playerKey=null,r.keyMode="api",r.createStream=function(e,t,r){if(!this.apiUrl)return"function"==typeof r&&r({error:"no api url set",request:{responseText:"no response error"}});if(!this.apiKey)return"function"==typeof r&&r({error:"no api key set",request:{responseText:"no response error"}});if("api"!==this.keyMode)return"function"==typeof r&&r({error:"wrong key mode set",request:{responseText:"no response error"}});var o=new n("POST",this.apiUrl+"/stream");o.header={Accept:"application/json","Content-Type":"application/json","X-BINTU-APIKEY":this.apiKey},o.onSuccess=t,o.onError=r;var s={webrtc:this.isWebrtcStream,transcoding:this.isTranscodedStream};"object"==typeof e&&"function"==typeof e.push&&e.length>0&&("string"==typeof e[0]||e[0]instanceof String)&&(s.tags=e),o.Send(s)},r.getStream=function(e,t,r){if(!this.apiUrl)return"function"==typeof r&&r({error:"no api url set",request:{responseText:"no response error"}});if(!this.apiKey&&"api"===this.keyMode)return"function"==typeof r&&r({error:"no api key set",request:{responseText:"no response error"}});var o=new n("GET",this.apiUrl+"/stream/"+e);o.header="api"===this.keyMode&&this.apiKey?{Accept:"application/json","Content-Type":"application/json","X-BINTU-APIKEY":this.apiKey}:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},o.onSuccess=t,o.onError=r,o.Send()},r.getStreams=function(t,r,o){if(!this.apiUrl)return"function"==typeof o&&o({error:"no api url set",request:{responseText:"no response error"}});if(!this.apiKey&&"api"===this.keyMode)return"function"==typeof o&&o({error:"no api key set",request:{responseText:"no response error"}});if(!this.playerKey&&"player"===this.keyMode)return"function"==typeof o&&o({error:"no player key set",request:{responseText:"no response error"}});var s=this.apiUrl+"/stream";if(t instanceof e){if(0===t.tags.length&&"player"===this.keyMode)return"function"==typeof o&&o({error:"no tags set",request:{responseText:"no response error"}});s+=t.getQueryString()}var i=new n("GET",s);i.header="api"===this.keyMode?{Accept:"application/json","Content-Type":"application/json","X-BINTU-APIKEY":this.apiKey}:{Accept:"application/json","Content-Type":"application/json","X-BINTU-PLAYERKEY":this.playerKey},i.onSuccess=r,i.onError=o,i.Send()},r.tagStream=function(e,t,r,o){if(!this.apiUrl)return"function"==typeof o&&o({error:"no api url set",request:{responseText:"no response error"}});if(!this.apiKey)return"function"==typeof o&&o({error:"no api key set",request:{responseText:"no response error"}});if("api"!==this.keyMode)return"function"==typeof o&&o({error:"wrong key mode set",request:{responseText:"no response error"}});if(!e)return"function"==typeof o&&o({error:"no stream id set"});var s=new n("PUT",this.apiUrl+"/stream/"+e+"/tag");s.header={Accept:"application/json","Content-Type":"application/json","X-BINTU-APIKEY":this.apiKey},s.onSuccess=r,s.onError=o,"object"==typeof t&&"function"==typeof t.push&&t.length>0&&("string"==typeof t[0]||t[0]instanceof String)?s.Send({tags:t}):s.Send()},r.pushStream=function(e,t,r,o){if(!this.apiUrl)return"function"==typeof o&&o({error:"no api url set",request:{responseText:"no response error"}});if(!this.apiKey)return"function"==typeof o&&o({error:"no api key set",request:{responseText:"no response error"}});if("api"!==this.keyMode)return"function"==typeof o&&o({error:"wrong key mode set",request:{responseText:"no response error"}});if(!e)return"function"==typeof o&&o({error:"no stream id set"});var s=new n("PUT",this.apiUrl+"/stream/"+e+"/push_url");s.header={Accept:"application/json","Content-Type":"application/json","X-BINTU-APIKEY":this.apiKey},s.onSuccess=r,s.onError=o,s.Send({url:t})},window.Bintu=t,r=e.prototype,e.STATE=Object.create({LIVE:"live",CREATED:"created",ENDED:"ended",ALL:null}),r.setState=function(t){var r=void 0;for(var n in e.STATE)e.STATE[n]===t&&(r=e.STATE[n]);if("undefined"==typeof r)throw new Error("The param 'state' must be of type 'BintuStreamFilter.STATE'");return this.state=r,this},r.addTag=function(e){if(!(e.length>0&&("string"==typeof e||e instanceof String)))throw new Error("The param 'tag' must be of type 'string' and also may not be empty string.");return this.tags.push(e),this.tags=this._reduceDuplicates(this.tags),this},r.addTags=function(e){if("object"!=typeof e||"function"!=typeof e.push||!(0===e.length||e.length>0&&("string"==typeof e[0]||e[0]instanceof String)))throw new Error("The param 'tags' must be of type 'string array'");return this.tags=this.tags.concat(e),this.tags=this._reduceDuplicates(this.tags),this},r.getQueryString=function(){var e="";if("object"==typeof this.tags&&"function"==typeof this.tags.push&&this.tags.length>0)for(var t=0;t<this.tags.length;t+=1)"string"==typeof this.tags[t]&&(e+=0==t?"?":"&",e+="tags[]="+this.tags[t]);return"string"==typeof this.state&&this.state.length>0&&(e+=e.indexOf("?")===-1?"?":"&",e+="state="+this.state),e},r._reduceDuplicates=function(e){if("object"!=typeof e||"function"!=typeof e.push||!(0===e.length||e.length>0&&("string"==typeof e[0]||e[0]instanceof String)))throw new Error("The param 'tags' must be of type 'string array'");return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])},window.BintuStreamFilter=e}).call(this)}]);